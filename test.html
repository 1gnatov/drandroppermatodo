<!DOCTYPE HTML>
<html>

<head>
    <script src="https://code.jquery.com/jquery-2.2.3.min.js" integrity="sha256-a23g1Nt4dtEYOj7bR+vTu7+T8VP13humZFBJNIYoEJo=" crossorigin="anonymous"></script>
    <style>
    .pseudo-top {
        width: 100%;
        height: 10px;
        color: white;
        position: relative;
    }
    .pseudo-bot {
        width: 100%;
        height: 10px;
        color: white;
        position: relative;
    }
    </style>
    <script type='text/javascript'>

    function allowDrop(ev) {
        var id = ev.dataTransfer.getData("text/plain")
        console.log("Flying id "+id);
        ev.dataTransfer.dropEffect = "move"
        ev.preventDefault();
    }

    function drag(ev) {
        console.log("dragged smth");
        ev.dataTransfer.setData("text/plain", ev.target.id);
        ev.dataTransfer.setData("text/html", ev.target.textContent);
        console.log(ev.target.id);
    }

    function dropBefore(ev) {
        ev.preventDefault();
        var id = ev.dataTransfer.getData("text/plain");
        var text = ev.dataTransfer.getData("text/html");
        console.log("Dropped id "+id);
        $('#'+id+'.todoelem').remove();
        $(ev.target).parent().before($(createListElem(id, text)));
    }

    function dropAfter(ev) {
        ev.preventDefault();
        var id = ev.dataTransfer.getData("text/plain");
        var text = ev.dataTransfer.getData("text/html");
        console.log("Dropped id "+id);
        $('#'+id+'.todoelem').remove();
        $(ev.target).parent().after($(createListElem(id, text)));
    }

    function createListElem(id, text) {
      $containerElem = $("<div id='"+ id +"' class='todoelem' ></div>")
      $elem = $("<div id='"+ id +"' class='bright1 rectangle stack nodrop' draggable='true' ondragstart='drag(event)' >"+text+"</div>")
      $topDropZone = $("<div id='"+ id +"' class='pseudo-top' ondrop='dropBefore(event)' ondragover='allowDrop(event)'></div>");
      $botDropZone = $("<div id='"+ id +"' class='pseudo-bot' ondrop='dropAfter(event)' ondragover='allowDrop(event)'></div>");
      console.log(text);
      $containerElem.append($topDropZone, $elem, $botDropZone);
      return $containerElem;
    }


    $(document).ready(function() {


        //adding element
        $("form").submit(function(e) {
            e.preventDefault();

            var text = $(".inp").val();
            var id = "id" + Math.random().toString(16).slice(2)

            $(".listed").append(createListElem(id,text));
        });

      });

    </script>
</head>

<body>
    <div class="custom list">
        <form>
            <input class="inp"></input>
        </form>
        <div class="listed"></div>
    </div>
</body>

</html>
